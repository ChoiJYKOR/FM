# FM 퓨즈 검수 AI 강의 시리즈 | 3부
## "분류 모델: 결함 5가지 자동 판단의 비결"

---

## 📚 **강의 목표**

**이 3부를 끝내면 당신도 알 수 있어요:**
- "YOLO가 찾은 불량, 그 다음은?"
- "어떤 결함인지 어떻게 판단할까?"
- "FM의 99.5% 신뢰도는 어떻게 달성했나?"
- "AI 검사의 전체 흐름은 뭔가?"

---

# **섹션 1: YOLO 이후, 분류 모델의 필요성**

## 🎯 **문제: YOLO는 "불량"을 찾지만, "무엇이 불량"인지는 모른다**

### **상황: YOLO의 한계**

```
YOLO 출력:
{
  "predictions": [
    {
      "confidence": 0.95,
      "bbox": {"x": 250, "y": 180, "width": 150, "height": 80}
    }
  ]
}

결과: "여기 뭔가 있다!" 
하지만 "뭐가" 있는지는 모른다? ❓

필요한 정보:
├─ 와이어 손상인가?
├─ 캡 손상인가?
├─ 표면 스크래치인가?
├─ 색상 이상인가?
└─ 마킹 오류인가?
```

### **해결책: 분류 모델 (Classification Model)**

```
YOLO가 찾은 영역 (ROI)
        ↓
분류 모델 (Classifier)
        ↓
"이건 와이어 손상이다!" (신뢰도 99.1%)
```

---

## 📊 **전체 검사 파이프라인**

```
1단계: YOLO (검출 모델)
"불량이 어디에 있는가?"
입력: 전체 이미지 (640 x 640)
출력: ROI (위치 + 신뢰도)
시간: 30ms
정확도: 99.2%

        ↓

2단계: Classifier (분류 모델)
"그 불량이 무엇인가?"
입력: YOLO가 찾은 영역 (예: 150 x 80)
출력: 결함 분류 + 신뢰도
시간: 20ms
정확도: 98.8%

        ↓

3단계: 최종 판단
두 모델의 신뢰도 결합
최종 신뢰도: 99.5% ✅
```

---

# **섹션 2: 분류 모델이란?**

## 🧠 **"이미지를 5가지 카테고리로 분류하는 AI"**

### **분류 모델의 기본 개념**

```
입력: 이미지 조각 (YOLO가 추출한 ROI)

처리: 신경망이 "이건 어느 카테고리?"를 판단

출력: 
├─ 클래스 1: normal_fuse (정상) - 확률 2%
├─ 클래스 2: wire_damage (와이어 손상) - 확률 95% ← 가장 높음!
├─ 클래스 3: cap_damage (캡 손상) - 확률 2%
├─ 클래스 4: surface_scratch (스크래치) - 확률 1%
└─ 클래스 5: marking_error (마킹 오류) - 확률 0%

최종 판단: "와이어 손상" (95% 확신)
```

### **CNN 분류 vs YOLO**

```
CNN 분류 (Classification):
"전체 이미지가 뭔지 분류" → "정상" or "불량"

YOLO 검출 (Detection):
"이미지에 뭐가 어디 있는지" → 위치 정보

분류 모델 (Classifier):
"특정 영역이 뭔지 분류" → "와이어 손상", "캡 손상" 등
```

---

# **섹션 3: FM 퓨즈의 5가지 결함 분류**

## 🏷️ **"분류 모델이 배운 5가지 결함"**

### **클래스 1: Normal (정상)**

```
특징:
├─ 와이어: 중앙에 곧게 나있음
├─ 캡: 양쪽 끝이 대칭
├─ 표면: 매끄럽고 손상 없음
├─ 색상: 정확한 FM 빨간색 (PANTONE 186C)
└─ 마킹: 선명하고 정확

이미지 특징 (픽셀 수준):
├─ RGB 값이 기준 범위 내
├─ 엣지가 명확
├─ 노이즈 최소
└─ 대칭성 높음

분류 모델의 신뢰도 기준:
└─ ≥ 90% → 자동 합격 ✅
```

### **클래스 2: Wire Damage (와이어 손상)**

```
특징 1: 와이어가 끊김
├─ 증상: 중앙의 검은 선이 끊어져 있음
├─ 심각도: 최고 (전체 기능 상실)
├─ 감지 위치: 중앙 (x=280-360, y=160-240)
└─ 확률: 자동 불량 ❌

이미지 특징:
├─ 연속성 단절 감지
├─ 엣지 불연속
├─ 검정색 영역에 간격
└─ CNN 필터: 직선 패턴 손상

특징 2: 와이어가 꺾임
├─ 증상: 와이어가 각도 형성
├─ 심각도: 중간 (통전은 되지만 구조 문제)
├─ 감지: 곡선 검출
└─ 확률: 거의 불량 (≥95%)

분류 모델의 신뢰도:
└─ 일반적으로 95% 이상
```

### **클래스 3: Cap Damage (캡 손상)**

```
특징 1: 캡이 깨짐
├─ 증상: 금속 캡에 균열이나 파손
├─ 위치: 양쪽 끝 (x=40-80 또는 x=560-600)
├─ 심각도: 높음 (안전 문제)
└─ 확률: 불량 ❌

특징 2: 캡이 비뚤어짐
├─ 증상: 정렬이 틀어짐
├─ 감지: 캡의 중심선이 오프셋
├─ 심각도: 낮음 (기능 유지)
└─ 확률: 의심 (70-85%)

이미지 특징:
├─ 원형의 비대칭성 증가
├─ 엣지 불규칙
├─ 특정 방향의 엣지 증가
└─ CNN 필터: 원형 패턴 왜곡

분류 모델의 신뢰도:
└─ 일반적으로 85-92%
```

### **클래스 4: Surface Scratch (표면 스크래치)**

```
특징:
├─ 미세한 선 패턴
├─ 이미지 곳곳에 산재
├─ 깊이가 얕음 (기능에 영향 없음)
├─ 색상: 여전히 빨간색
└─ 심각도: 낮음 (미용상 문제)

이미지 특징:
├─ 고주파 노이즈 증가
├─ 국소적인 엣지
├─ 표면 텍스처 거칠음
└─ CNN 필터: 미세한 선 패턴

감지 방법:
├─ 표면 거칠기 분석
├─ 국소 엣지 검출
└─ 텍스처 분석

분류 모델의 신뢰도:
└─ 일반적으로 78-88% (≥80%이면 재검사)
```

### **클래스 5: Marking Error (마킹 오류)**

```
특징 1: 글자가 겹침
├─ 증상: 마킹 글자가 정렬 안 됨
├─ 위치: 상단/하단 레이블
├─ 심각도: 낮음 (기능 유지)
└─ 확률: 의심 (70-80%)

특징 2: 글자가 흐림
├─ 증상: 마킹이 선명하지 않음
├─ 감지: 글자 경계 유연함
├─ 심각도: 낮음
└─ 확률: 의심 (65-75%)

특징 3: 글자 누락
├─ 증상: 마킹의 일부가 없음
├─ 감지: 예상 영역에 신호 없음
├─ 심각도: 중간 (추적 불가능)
└─ 확률: 불량 (≥90%)

이미지 특징:
├─ 텍스트 영역의 대비 변화
├─ 글자 엣지의 일관성 감소
├─ 특정 영역의 밝기 변화
└─ CNN 필터: 텍스트 패턴 인식

분류 모델의 신뢰도:
└─ 일반적으로 75-90%
```

### **클래스 6: Color Abnormal (색상 이상)**

```
특징:
├─ FM 표준 빨간색이 아님
├─ 너무 밝거나 어두움
├─ RGB 값이 기준 범위 밖
└─ 심각도: 낮음 (재도장 필요)

표준 색상:
└─ FM Red (PANTONE 186C)
   ├─ R: 211 ± 10
   ├─ G: 33 ± 5
   └─ B: 47 ± 5

이미지 특징:
├─ RGB 히스토그램 변화
├─ 색상 채널 비율 변화
├─ 전체 밝기 변화
└─ 포화도 변화

분류 모델의 신뢰도:
└─ 일반적으로 80-92%
```

---

# **섹션 4: 분류 모델의 구조 (ResNet50)**

## 🏗️ **"가장 많이 쓰는 분류 모델"**

### **ResNet50 구조**

```
ResNet = Residual Network
= "연결을 건너뛸 수 있는 신경망"

입력: ROI 이미지 (224 x 224)
        ↓
┌─────────────────────────────┐
│ Conv Block 1                │
│ ├─ 합성곱층                 │
│ ├─ 배치 정규화              │
│ ├─ ReLU 활성화              │
│ └─ Residual 연결 ← 핵심!    │
└─────────────────────────────┘
        ↓
┌─────────────────────────────┐
│ Conv Block 2-4              │
│ (같은 구조 반복)            │
└─────────────────────────────┘
        ↓
┌─────────────────────────────┐
│ Global Average Pooling      │
│ (특징 요약)                 │
└─────────────────────────────┘
        ↓
┌─────────────────────────────┐
│ Fully Connected Layer       │
│ ├─ 입력: 2048개 특징        │
│ └─ 출력: 6개 클래스 확률    │
└─────────────────────────────┘
        ↓
결과: 
[정상:2%, 와이어:95%, 캡:2%, 스크래치:1%, 마킹:0%, 색상:0%]
```

### **Residual Connection (잔차 연결)**

```
일반 신경망:
입력 → [레이어] → 출력

문제: 레이어가 많으면 정보 손실

ResNet:
입력 → [레이어] → 출력
  ↓                    ↑
  └────────────────────┘  ← 원본 입력도 더해짐!

효과:
├─ 깊은 네트워크도 학습 가능 (50층!)
├─ 정보 손실 최소화
└─ 더 정확한 분류
```

### **FM 퓨즈용 ResNet50 변형**

```
표준 ResNet50:
├─ 입력: 224 x 224 이미지
├─ 클래스: 1000개 (ImageNet)
└─ 파라미터: 25.5M

FM 커스터마이징:
├─ 입력: 224 x 224 이미지 (같음)
├─ 클래스: 6개 (정상, 와이어, 캡, 스크래치, 마킹, 색상)
└─ 파라미터: 25.5M (대부분 고정, 마지막 층만 학습)

미세 조정 (Fine-tuning):
├─ 처음 40층: 고정 (ImageNet 사전학습)
├─ 마지막 14층: 학습 (FM 데이터로 재학습)
└─ 장점: 빠른 수렴 + 높은 정확도
```

---

# **섹션 5: 다른 분류 모델들**

## 🏆 **"FM이 고려할 수 있는 다른 모델들"**

### **모델 비교**

```
┌───────────────┬──────────┬──────────┬────────┬──────────┐
│ 모델          │ 정확도   │ 속도     │ 크기   │ 추천도   │
├───────────────┼──────────┼──────────┼────────┼──────────┤
│ ResNet50      │ 98.8%    │ 30ms     │ 98MB   │ ⭐⭐⭐⭐⭐ │
│ EfficientNet  │ 99.1%    │ 20ms     │ 35MB   │ ⭐⭐⭐⭐   │
│ VGG16         │ 97.5%    │ 50ms     │ 138MB  │ ⭐⭐⭐    │
│ Inception-v3  │ 98.5%    │ 40ms     │ 92MB   │ ⭐⭐⭐⭐   │
│ MobileNet-v2  │ 96.2%    │ 15ms     │ 14MB   │ ⭐⭐⭐    │
│ Vision Trans  │ 99.3%    │ 100ms    │ 300MB  │ ⭐⭐⭐    │
└───────────────┴──────────┴──────────┴────────┴──────────┘

FM의 선택: ResNet50
- 정확도와 속도의 최고 균형
- 산업용 표준
- 사용 사례 많음
```

### **EfficientNet (경량 버전)**

```
특징:
├─ 더 작음 (35MB vs 98MB)
├─ 더 빠름 (20ms vs 30ms)
├─ 정확도 더 높음 (99.1% vs 98.8%)
└─ 모바일 기기에도 배포 가능

장점:
├─ Edge Device 배포 가능
├─ 에너지 소비 적음
└─ 실시간성 더 좋음

단점:
├─ 학습 시간 더 오래 걸림
└─ 파라미터 수 더 많음 (상대적으로)
```

---

# **섹션 6: 분류 모델의 학습 과정**

## 📚 **"FM 퓨즈 분류 모델을 만드는 과정"**

### **Step 1: 데이터 준비**

```
YOLO가 찾은 ROI 영역만 추출:

원본 이미지 (640 x 640) 
        ↓
YOLO 감지 (ROI 출력: 위치 + 크기)
        ↓
크롭 및 리사이즈 (224 x 224)
        ↓
분류 데이터셋 생성

클래스별 이미지 수:
├─ 정상: 10,000장
├─ 와이어 손상: 2,500장
├─ 캡 손상: 2,500장
├─ 표면 스크래치: 2,000장
├─ 마킹 오류: 2,000장
└─ 색상 이상: 1,000장
총합: 20,000장
```

### **Step 2: 데이터 분할**

```
20,000장 → 3가지로 분할

훈련 데이터 (Training Set): 70%
├─ 14,000장
├─ 모델 학습에 사용
└─ 모델이 이 데이터로 가중치 조정

검증 데이터 (Validation Set): 15%
├─ 3,000장
├─ 학습 중 모니터링
└─ 과적합 여부 판단

테스트 데이터 (Test Set): 15%
├─ 3,000장
├─ 최종 성능 평가
└─ 실제 정확도 측정
```

### **Step 3: 전이 학습 (Transfer Learning)**

```
전이 학습 = "다른 데이터로 학습한 모델 재사용"

1단계: 사전학습 모델 로드
└─ ImageNet으로 학습한 ResNet50
   (1000만 개 이미지로 1000개 클래스 학습)

2단계: 마지막 층 교체
└─ 기존 1000개 출력 → FM 6개 출력으로 변경

3단계: 미세 조정 (Fine-tuning)
├─ 초기 40층: 고정 (ImageNet 가중치 유지)
├─ 마지막 14층: 학습 (FM 데이터로 재학습)
└─ 이유: 빠른 수렴 + 적은 데이터로도 높은 정확도

시간:
├─ 전이 학습 (Fine-tuning): 2~3시간
├─ 처음부터 학습: 48시간 이상
└─ 시간 절감: 16배 이상!
```

### **Step 4: 학습 과정**

```
설정:
├─ 모델: ResNet50 (미세 조정)
├─ Optimizer: Adam (학습률 0.0001)
├─ Batch size: 32
├─ Epochs: 50
└─ Loss function: Cross Entropy

학습 과정:

Epoch 1:   Train Acc: 82%  Val Acc: 79%  (학습 시작)
Epoch 5:   Train Acc: 91%  Val Acc: 88%  (배우는 중)
Epoch 10:  Train Acc: 95%  Val Acc: 93%  (거의 다 배움)
Epoch 20:  Train Acc: 97%  Val Acc: 95%  (안정화)
Epoch 30:  Train Acc: 98%  Val Acc: 96%  (수렴)
Epoch 40:  Train Acc: 98.5%Val Acc: 96.5%(거의 끝)
Epoch 50:  Train Acc: 98.8%Val Acc: 96.8%(완성!)

최종 결과:
└─ 훈련 정확도: 98.8%
└─ 검증 정확도: 96.8%
└─ 테스트 정확도: 96.5%

선택된 모델:
└─ Epoch 30 (Val Acc 95% 이후 중단)
   (과적합 방지 - Validation 정확도가 떨어지기 전)
```

---

# **섹션 7: 분류 모델의 신뢰도 분석**

## 📊 **"각 클래스별 정확도"**

### **Confusion Matrix (혼동 행렬)**

```
실제 vs 예측:

                예측값
         정상  와이어 캡  스크래치 마킹  색상
실제값
정상     98%   1%    0%   0.5%    0.2%  0.3%
와이어   1%    97%   1%   0.5%    0.2%  0.3%
캡      2%    1%    95%  1%      0.5%  0.5%
스크래치 3%    1%    1%   94%     0.5%  0.5%
마킹     2%    2%    1%   1%      93%   1%
색상     5%    2%    2%   2%      2%    87%

해석:
├─ 대각선 (맞은 것)이 높을수록 좋음
├─ 와이어 손상: 97% 정확도 ✅
├─ 캡 손상: 95% 정확도 ✅
├─ 표면 스크래치: 94% 정확도 ✅
├─ 마킹 오류: 93% 정확도 ✅
└─ 색상 이상: 87% 정확도 (개선 필요)
```

### **클래스별 성능 지표**

```
┌─────────────┬───────────┬─────────┬──────────┬────────┐
│ 클래스      │ 정확도    │ 재현율  │ F1-Score │ 샘플수 │
├─────────────┼───────────┼─────────┼──────────┼────────┤
│ 정상        │ 98.2%     │ 98.0%   │ 98.1%    │ 3,000  │
│ 와이어 손상 │ 97.1%     │ 97.3%   │ 97.2%    │ 750    │
│ 캡 손상     │ 95.3%     │ 95.0%   │ 95.1%    │ 750    │
│ 스크래치    │ 94.2%     │ 94.0%   │ 94.1%    │ 600    │
│ 마킹 오류   │ 93.5%     │ 93.2%   │ 93.3%    │ 600    │
│ 색상 이상   │ 87.1%     │ 86.8%   │ 86.9%    │ 300    │
├─────────────┼───────────┼─────────┼──────────┼────────┤
│ 평균        │ 94.2%     │ 94.0%   │ 94.1%    │ 6,000  │
└─────────────┴───────────┴─────────┴──────────┴────────┘

정의:
- 정확도 = 맞게 분류한 비율
- 재현율 = 실제 결함을 놓치지 않은 비율
- F1-Score = 정확도와 재현율의 조화평균
```

---

# **섹션 8: FM의 99.5% 신뢰도 달성 과정**

## 🏆 **"YOLO + 분류 모델의 통합"**

### **신뢰도 계산 공식**

```
FM의 99.5% 신뢰도 = 3단계의 조합

단계 1: YOLO 검출 신뢰도
└─ 불량이 어디 있는가? → 99.2% 정확도

단계 2: 분류 모델 신뢰도
└─ 그 불량이 뭔가? → 96.5% 정확도

단계 3: 임계값 기반 필터링
└─ AI 확신도가 낮으면 → 인간 검증

최종 계산:
┌─────────────────────────────────────┐
│ 신뢰도 = YOLO × 분류 × 필터링       │
│ = 0.992 × 0.965 × 0.999            │
│ = 0.9568 (약 95.68%)                │
│                                     │
│ + 재검사/인간 검증: 0.3~1%          │
│ = 약 96.5%                          │
│                                     │
│ 최종 + 최종 검증: 99.5% ✅          │
└─────────────────────────────────────┘
```

### **신뢰도 향상 전략**

```
방법 1: 임계값 조정
├─ 신뢰도 85% 미만 → 자동 재검사
├─ 신뢰도 85~95% → 인간 최종 확인
└─ 신뢰도 95% 이상 → 자동 통과

방법 2: 앙상블 모델 (Ensemble)
├─ ResNet50 + EfficientNet 동시 실행
├─ 둘 다 같은 결론 → 자동 통과
├─ 다른 결론 → 인간 검증
└─ 효과: 정확도 1~2% 추가 향상

방법 3: 재검사 라인
├─ AI가 "의심"한 제품들만 별도 검사
├─ 부산 기준으로 인간 검사원 2명
├─ 합의 결과 → 최종 판단
└─ 효과: 신뢰도 0.5~1% 추가 향상
```

---

# **섹션 9: 실시간 모니터링 대시보드**

## 📈 **"AI 검사 시스템의 상태를 한눈에"**

### **대시보드 구성**

```
┌────────────────────────────────────────────────┐
│         FM 퓨즈 검수 AI 대시보드                │
├────────────────────────────────────────────────┤
│                                                │
│ 📊 실시간 통계                                 │
│ ├─ 오늘 검사량: 45,000개                      │
│ ├─ 합격률: 95.2%                              │
│ ├─ 불량률: 4.8%                              │
│ └─ 평균 신뢰도: 99.4%                         │
│                                                │
│ 🎯 결함별 분포                                 │
│ ├─ 정상: 42,840개 (95.2%)                     │
│ ├─ 와이어 손상: 1,200개 (2.7%) ⚠️            │
│ ├─ 캡 손상: 600개 (1.3%)                      │
│ ├─ 스크래치: 180개 (0.4%)                     │
│ ├─ 마킹 오류: 120개 (0.3%)                    │
│ └─ 색상 이상: 60개 (0.1%)                     │
│                                                │
│ ⚡ 성능 지표                                   │
│ ├─ YOLO 평균 처리 시간: 29.8ms                │
│ ├─ 분류 모델 평균 시간: 19.2ms                │
│ ├─ 전체 파이프라인: 49.0ms                    │
│ └─ 초당 처리량: 20.4개                        │
│                                                │
│ 🚨 경고 항목                                   │
│ ├─ 와이어 손상 급증 ⚠️ (어제보다 50% ↑)      │
│ ├─ 색상 이상 증가 (공정 점검 필요)            │
│ └─ 카메라 1 포커스 이상 (점검 예정)           │
│                                                │
│ 📅 시간대별 합격률                             │
│ ├─ 08:00~12:00: 96.2% ✅                      │
│ ├─ 12:00~16:00: 94.8% ⚠️                     │
│ ├─ 16:00~20:00: 95.1%                        │
│ └─ 20:00~00:00: 95.5%                        │
│                                                │
│ 🔧 카메라 상태                                 │
│ ├─ 카메라 1: 정상 ✅ (29.5ms)                 │
│ ├─ 카메라 2: 정상 ✅ (30.2ms)                 │
│ └─ 카메라 3: 정상 ✅ (30.1ms)                 │
│                                                │
│ 🧠 모델 성능                                   │
│ ├─ YOLO 정확도: 99.2%                         │
│ ├─ 분류 모델: 96.8%                           │
│ ├─ 앙상블 모델: 98.1%                         │
│ └─ 최종 신뢰도: 99.5%                         │
│                                                │
└────────────────────────────────────────────────┘
```

### **실시간 알림 설정**

```
경고 조건:
├─ 불량률 5% 이상 → 즉시 알림
├─ 특정 카메라 응답 시간 50ms 초과 → 알림
├─ 모델 신뢰도 96% 이하 → 알림
├─ 재검사 큐 100개 초과 → 알림
└─ 카메라 연결 끊김 → 긴급 알림

알림 대상:
├─ QA 팀 (실시간 알림)
├─ 생산 팀 (일일 보고)
├─ AI 개발 팀 (주간 분석)
└─ 경영진 (월간 리포트)
```

---

# **섹션 10: 전체 검사 플로우**

## 🏭 **"FM의 AI 검사 라인 완전 정리"**

### **0. 퓨즈 입력 (0초)**

```
생산 라인에서 정해진 속도로 퓨즈 통과
├─ 속도: 초당 3~5개
└─ 대기열: 컨베이어 벨트 위
```

### **1. 카메라 촬영 (0~0.1초)**

```
3개 카메라 동시 촬영:

카메라 1 (정면):
├─ 퓨즈 전체 형태
├─ 와이어 상태
└─ 글로벌 정렬

카메라 2 (옆면):
├─ 와이어 수직성
├─ 캡 정렬
└─ 높이 확인

카메라 3 (색상):
├─ RGB 값
├─ 표면 상태
└─ 마킹 선명도

총 이미지: 3장 (각 640x640)
```

### **2. YOLO 검출 (0.1~0.13초)**

```
3개 카메라 이미지 동시 처리:

각 카메라별:
├─ YOLO 모델 실행 (30ms)
├─ ROI 추출 (여러 개 가능)
└─ 신뢰도 계산

출력:
├─ 카메라 1 결과: [정상, 신뢰도 99.2%]
├─ 카메라 2 결과: [정상, 신뢰도 98.5%]
└─ 카메라 3 결과: [정상, 신뢰도 97.8%]

판단: "불량 여부?" → 모두 정상 ✅
```

### **3. 불량 확인 및 분류 (0.13~0.17초)**

```
모두 정상이면:
└─ 분류 모델 스킵 (시간 절감)
└─ 바로 합격 판정

만약 불량 감지되면:
├─ YOLO가 찾은 ROI 추출 (224x224)
├─ 분류 모델 실행 (20ms)
└─ 결함 종류 판단

분류 결과 예:
└─ "와이어 손상" (신뢰도 98.7%)
```

### **4. 신뢰도 판정 (0.17~0.18초)**

```
신뢰도 검사:
├─ YOLO × 분류 = 99.2% × 98.7% = 97.9%
├─ 최종 신뢰도 >= 95%? → YES
└─ 결론: "불량" ❌

판정 과정:
├─ 신뢰도 95% 이상: 자동 처리 (0.1초)
├─ 신뢰도 85~95%: 재검사 대기열 (2초)
└─ 신뢰도 85% 미만: 인간 검증 (30초)
```

### **5. 최종 처리 (0.18~0.2초)**

```
퓨즈 #1이 불량인 경우:
├─ 신뢰도: 99.2% (자동)
├─ 분류: 와이어 손상
├─ 처리: 불량 구간으로 자동 이동
├─ 기록: DB에 저장 (이미지 + 결과)
└─ 시간: 0.2초 총 소요

다음 퓨즈 #2 처리 시작:
└─ 0.2초 후 새로운 이미지 입력
```

### **시간대별 처리 예시**

```
프레임 #1 (0.0초)
├─ 퓨즈 #1 입력
├─ 카메라 촬영
├─ YOLO 처리
└─ 결과: 정상 ✅

프레임 #2 (0.2초)
├─ 퓨즈 #2 입력
├─ 카메라 촬영
├─ YOLO 처리
└─ 결과: 와이어 손상 ❌

프레임 #3 (0.4초)
├─ 퓨즈 #3 입력
├─ 카메라 촬영
├─ YOLO 처리
└─ 결과: 정상 ✅

초당 처리: 5개 (생산 속도 충분 초과 처리)
```

---

# **섹션 11: 에러 분석 & 개선**

## 🔍 **"AI가 실수하는 경우와 개선 방법"**

### **False Positive (거짓 양성) - 정상을 불량으로 판정**

```
예시:
└─ 실제: 정상
└─ AI: "와이어 손상" (신뢰도 92%)

원인 분석:
├─ 조명 방향이 특이한 경우
├─ 와이어 위의 먼지
├─ 카메라 초점 약간 흐림
└─ 학습 데이터에 유사 케이스 부족

발생률: 0.8% (실제 정상 중 0.8%)

해결책:
├─ 더 많은 정상 이미지 수집
├─ 조명 개선
├─ 신뢰도 기준 상향 (92% → 95%)
├─ 데이터 증강으로 다양성 추가
└─ 효과: 0.8% → 0.3%로 개선
```

### **False Negative (거짓 음성) - 불량을 정상으로 판정**

```
예시:
└─ 실제: 와이어 손상
└─ AI: "정상" (신뢰도 88%)

원인 분석:
├─ 와이어 손상이 미세한 경우
├─ 카메라 각도가 안 좋은 경우
├─ 학습 데이터 부족 (와이어 손상)
└─ 모델이 아직 학습 중

발생률: 1.2% (실제 불량 중 1.2%)

해결책:
├─ 와이어 손상 이미지 더 수집 (2,500 → 5,000)
├─ 카메라 추가 (현재 3개 → 4개)
├─ 미세 손상 감지 분류기 추가
├─ 신뢰도 기준 하향 (95% → 85%)
└─ 효과: 1.2% → 0.1%로 개선

중요성:
└─ False Negative는 고객에게 나쁜 제품 전달!
└─ False Positive는 비용 손실 (하지만 안전)
```

---

# **섹션 12: 미래 개선 계획**

## 🚀 **"FM이 나아갈 방향"**

### **단기 (3개월)**

```
1. 색상 이상 감지 개선
   ├─ 현재: 87% 정확도
   ├─ 목표: 95% 정확도
   ├─ 방법: 더 많은 색상 이상 샘플 수집
   └─ 효과: 신뢰도 0.3% 향상

2. 카메라 4번째 추가
   ├─ 위치: 대각선 (현재: 정면, 옆, 색상)
   ├─ 목적: 모서리 부분 강화
   └─ 효과: 신뢰도 0.2% 향상
```

### **중기 (6개월)**

```
1. Vision Transformer 도입
   ├─ 모델: ViT (Vision Transformer)
   ├─ 정확도: 99.3% (ResNet 98.8% 대비)
   ├─ 속도: 100ms (ResNet 30ms 대비 느림)
   ├─ 해결책: 두 모델 병렬 실행 (더 빠른 것 우선)
   └─ 효과: 신뢰도 0.5% 향상

2. 3D 검사 카메라 도입
   ├─ 현재: 2D 이미지 (평면)
   ├─ 추가: 3D 깊이 정보
   ├─ 가능해지는 것: 캡 높이, 와이어 곡률 정밀 검사
   └─ 효과: 신뢰도 0.2% 향상

목표: 99.5% → 99.8%
```

### **장기 (1년)**

```
1. 자동 재학습 시스템
   ├─ 매주 새로운 불량품 학습
   ├─ 자동으로 모델 업데이트
   └─ 항상 최신 상태 유지

2. 예측적 유지보수 (Predictive Maintenance)
   ├─ "다음주 불량률이 증가할 거야"라고 예측
   ├─ 생산 공정 미리 조정
   └─ 불량품 생산 자체 방지

3. 엣지 AI 컴퓨팅
   ├─ 클라우드 의존 감소
   ├─ 로컬에서 모두 처리
   ├─ 응답 속도: 50ms → 10ms
   └─ 네트워크 독립적 운영

목표: 99.8% → 99.95% (거의 완벽)
```

---

# **최종 요약: 3부 정리**

## ✅ **당신이 배운 것**

```
1️⃣ 분류 모델의 필요성
   - YOLO는 "어디"를 찾고
   - 분류 모델은 "뭔지"를 판단

2️⃣ ResNet50의 작동 원리
   - Residual Connection의 강력함
   - 깊은 신경망도 학습 가능

3️⃣ FM 퓨즈의 6가지 분류
   - 정상, 와이어 손상, 캡 손상
   - 스크래치, 마킹 오류, 색상 이상

4️⃣ 전이 학습의 활용
   - ImageNet 사전학습으로 2시간만에 학습
   - 처음부터 학습하면 48시간 필요

5️⃣ 신뢰도 계산의 비밀
   - YOLO × 분류 × 필터링 = 최종 신뢰도
   - 재검사와 인간 검증으로 99.5% 달성

6️⃣ 전체 검사 파이프라인
   - 0.2초에 완성되는 검사 프로세스
   - 초당 5개 처리 가능

7️⃣ 실시간 모니터링
   - 대시보드로 상태 파악
   - 경고 시스템으로 즉각 대응

8️⃣ 에러 분석 & 개선
   - False Positive vs False Negative
   - 데이터 수집과 모델 개선의 중요성
```

---

## 🏆 **FM의 99.5% 신뢰도 달성 과정 정리**

```
1단계: 초기 상태 (AI 없음)
└─ 인간 검사: 95% 신뢰도 (피로, 실수)

2단계: YOLO 도입
└─ AI 검사 + 인간 최종 검증: 97.5% 신뢰도

3단계: 분류 모델 추가
└─ YOLO + 분류 + 인간 재검사: 99.2% 신뢰도

4단계: 최적화 & 튜닝
└─ 신뢰도 임계값 조정 + 앙상블: 99.5% 신뢰도

최종: FM의 검수 품질 ✅ 99.5%
      = 100만개 중 불량 5,000개 미만!
```

---

## 🎓 **1부 + 2부 + 3부 완전 정복!**

| 강의 | 주제 | 핵심 메시지 |
|------|------|-----------|
| **1부** | CNN & 이미지 처리 | "컴퓨터 눈의 원리" |
| **2부** | YOLO & 초고속 감지 | "초당 30개 검사의 비결" |
| **3부** | 분류 & 신뢰도 달성 | "99.5% 품질의 비결" |

---

## 💡 **당신이 기억해야 할 3가지**

```
1. AI 검사 = 3단계 통합 시스템
   (카메라 입력 → YOLO → 분류 → 최종 판단)

2. 신뢰도 향상 = 데이터 + 모델 + 검증의 조합
   (더 많은 데이터 + 더 나은 모델 + 인간 검증)

3. 산업용 AI = 완벽함 추구
   (99.5%도 0.5% 개선을 위해 끊임없이 노력)
```

---

## 💬 **자주 묻는 질문 (FAQ)**

**Q: 분류 모델이 왜 따로 필요해요?**
A: YOLO는 위치만 알려주고, 분류 모델은 그게 뭔지 알려줘요. 속도 & 정확도 모두 중요합니다!

**Q: ResNet50은 왜 선택했나요?**
A: 정확도(98.8%)와 속도(30ms)의 최고 균형이기 때문입니다. EfficientNet이 약간 더 빠르지만, ResNet이 산업 표준입니다.

**Q: 전이 학습이 정말 2배 빠른가요?**
A: 네! ImageNet으로 사전학습된 모델을 재사용하면, 처음부터 학습할 때보다 16배 빠릅니다 (48시간 → 3시간).

**Q: False Negative를 줄이려면?**
A: 불량품 이미지를 더 많이 수집하고, 신뢰도 기준을 낮추면 됩니다. 대신 False Positive는 늘어나니 균형이 중요합니다.

**Q: 99.5%를 넘으려면?**
A: Vision Transformer 같은 최신 모델 도입, 3D 카메라 추가, 앙상블 모델 확대 등이 필요합니다. 하지만 비용 & 복잡도가 급증합니다.

**Q: 모델을 얼마나 자주 재학습해요?**
A: 현재는 월 1회, 향후 계획은 주 1회입니다. 완전 자동화는 AI 개발 로드맵 1년차 목표입니다.

**Q: 대시보드는 실시간인가요?**
A: 네, 0.1초 단위로 업데이트됩니다. 경고는 즉시 발송되어 QA 팀이 빠르게 대응할 수 있습니다.

---

## 🎉 **FM의 AI 검수 강의 완료!**

당신은 이제:
- ✅ CNN부터 YOLO까지의 진화 과정 이해
- ✅ 분류 모델로 정확한 판단 가능
- ✅ 99.5% 신뢰도 달성 방법 인식
- ✅ 전체 검사 시스템의 구조 파악

**당신은 이제 FM의 AI 검수 전문가입니다!** 🚀

---

*이 강의 자료는 FM Safety의 "AI 검수 공정" 투명성 프로젝트입니다.*
*3부작 강의로 완벽히 이해하는 산업용 AI 검사 시스템!*
*퓨즈 검수의 99.5% 신뢰도 - 이제 당신도 그 비결을 압니다!* 🏆
